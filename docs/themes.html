<!DOCTYPE html>
<html lang="en">

<head>
    <title>Theme Switcher | Tower Bootstrap Theme</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Demo of custom Bootstrap theme">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.3.67/css/materialdesignicons.min.css" rel="stylesheet" />
    <link href="css/bootsteam-theme.min.css" rel="stylesheet" />
    <script src="scripts/themeHandler.js" type="text/javascript"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a href="#" class="navbar-brand">Tower Bootstrap Theme</a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-collapse-area">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbar-collapse-area">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown">
                        <button type="button" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <span id="current-theme"></span> <span class="d-md-none">Switch Themes</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end">
                            <button type="button" class="dropdown-item" data-bs-theme-value="light"><span class="mdi mdi-weather-sunny"></span> Light</button>
                            <button type="button" class="dropdown-item" data-bs-theme-value="dark"><span class="mdi mdi-weather-night"></span> Dark</button>
                            <button type="button" class="dropdown-item" data-bs-theme-value="auto"><span class="mdi mdi-theme-light-dark"></span> Auto</button>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a href="https://github.com/StrutTower/tower-bootstrap-theme" rel="noreferrer noopener" class="nav-link">
                            GitHub
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container mt-5 pt-2">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">Homepage</a></li>
            <li class="breadcrumb-item active">Theme Switcher</li>
        </ol>

        <p>
            More info on how Bootstrap's theme switching works can be found here:
            <a href="https://getbootstrap.com/docs/5.3/customize/color-modes/">https://getbootstrap.com/docs/5.3/customize/color-modes/</a>
        </p>

        <p>
            This code is similar to the code provided on Bootstraps' website but is set up to work with classes instead of SVGs so you can use a font icon library.
        </p>

        <p>
            First create a new JavaScript file with the following code. This should be separate from any bundling, if you are doing that.
            This is because you want to include this code high up on the DOM to prevent the screen from flashing white when it loads.
        </p>

        <h5>ThemeHandler Javascript</h5>
        <div class="card mb-3">
            <div class="card-body bg-dark text-light">
                <pre><code>// Update the theme ASAP to prevent the view flashing white
updateTheme(localStorage.getItem('preferred-theme'));

// Updates to the supplied theme
function updateTheme(theme) {
    if (theme === null || theme === 'auto') {
        theme = getPreferedTheme();
        updateThemeSelector('auto');
    } else {
        updateThemeSelector(theme);
    }
    document.documentElement.setAttribute('data-bs-theme', theme);
}

// Returns the prefers-color-scheme setting 
function getPreferedTheme() {
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
}

// Updates the theme selector icon
function updateThemeSelector(theme) {
    document.querySelectorAll('[data-bs-theme-value]').forEach(function (selector) {
        if (selector.getAttribute('data-bs-theme-value') === theme) {
            selector.classList.add('active');
            document.getElementById('current-theme').className = selector.firstElementChild.className
        } else {
            selector.classList.remove('active');
        }
    });
}

document.addEventListener('DOMContentLoaded', function () {
    // Update the theme again after the page has loaded. This is mainly to update the theme picker icon.
    updateTheme(localStorage.getItem('preferred-theme'));

    // Add event listener to the theme switcher buttons
    document.querySelectorAll('[data-bs-theme-value]').forEach(function (button) {
        button.addEventListener('click', function () {
            const theme = button.getAttribute('data-bs-theme-value');
            if (theme === 'auto') {
                localStorage.removeItem('preferred-theme');
            } else {
                localStorage.setItem('preferred-theme', theme);
            }
            updateTheme(theme);
        });
    });
});

// Add an event listener if prefers-color-scheme is updated.
window.matchMedia('(prefers-color-scheme: dark)')
    .addEventListener('change', ({ matches }) => {
        const theme = localStorage.getItem('preferred-theme');
        if (theme === null || theme === 'auto') {
            updateTheme(getPreferedTheme());
        }
});</code></pre>
            </div>
        </div>

        <p>
            Add a script tag to the head of the page. It needs to included early on the DOM to prevent the page from flashing white if someone has defaulted to a dark theme.
        </p>

        <p>
            Add the following to the navbar's menu. This example is using Material Design Icons,
            <a href="https://pictogrammers.com/library/mdi" target="_blank" rel="noopener noreferrer">https://pictogrammers.com/library/mdi</a>
        </p>

        <h5>Navbar Theme Selector HTML</h5>
        <div class="card mb-3">
            <div class="card-body bg-dark text-light">
                <pre><code>&lt;li class=&quot;nav-item dropdown&quot;&gt;
    &lt;button type=&quot;button&quot; class=&quot;nav-link dropdown-toggle&quot; data-bs-toggle=&quot;dropdown&quot;&gt;
        &lt;span id=&quot;current-theme&quot;&gt;&lt;/span&gt; &lt;span class=&quot;d-md-none&quot;&gt;Switch Themes&lt;/span&gt;
    &lt;/button&gt;
    &lt;div class=&quot;dropdown-menu&quot;&gt;
        &lt;button type=&quot;button&quot; class=&quot;dropdown-item&quot; data-bs-theme-value=&quot;light&quot;&gt;&lt;span class=&quot;mdi mdi-weather-sunny&quot;&gt;&lt;/span&gt; Light&lt;/button&gt;
        &lt;button type=&quot;button&quot; class=&quot;dropdown-item&quot; data-bs-theme-value=&quot;dark&quot;&gt;&lt;span class=&quot;mdi mdi-weather-night&quot;&gt;&lt;/span&gt; Dark&lt;/button&gt;
        &lt;button type=&quot;button&quot; class=&quot;dropdown-item&quot; data-bs-theme-value=&quot;auto&quot;&gt;&lt;span class=&quot;mdi mdi-theme-light-dark&quot;&gt;&lt;/span&gt; Auto&lt;/button&gt;
    &lt;/div&gt;
&lt;/li&gt;</code></pre>
            </div>
        </div>

    </main>

    <footer class="container">
        <hr />
        <p>TowerSoft</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="scripts/scripts.js"></script>
</body>

</html>